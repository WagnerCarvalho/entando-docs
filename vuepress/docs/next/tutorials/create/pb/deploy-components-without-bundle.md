---
redirectFrom: /next/tutorials/ecr/tutorials/ecr-deploy-use-plugin-and-mfe-without-bundle.html
---
# Install Plugins and Micro Frontends without a Bundle

## Overview

In this tutorial you will learn how to install a plugin and micro frontend, generated with the Entando Blueprint, without the need to include the components in a bundle. Once the plugin is deployed into a cluster, link it to the EntandoApp, upload the static resources, and create the widgets for your app from the Entando App Builder.

## Prerequisites

-   An Entando plugin built with the Entando Component Generator and populated with Micro 
Frontends. [Generate a plugin and Micro Frontend here](../ms/generate-microservices-and-micro-frontends.md). 

-   Node and npm installed (use the LTS version)

-   Docker installed and able to upload images to Docker Hub or a repository of your choice

-   An instance of the Entando platform running on Kubernetes. See [Getting Started](../../../docs/getting-started/README.md).

::: tip Note
[Here is a definition of an Entando plugin](../../../docs/curate/ecr-bundle-details.md#plugin), including information on the runtime contract required for using non-Java based plugins.
:::


## Generate a Docker image 

JHipster uses the JIB Maven plugin to generate a Docker image for your
microservice.

The name of the output image generated with JIB during the setup wizard is defined with:
- The organization name you chose; default is set to `entando`
- The name of the application
- Version `0.0.1-SNAPSHOT`

For example, a custom organization name of `myorg` and an application name of `jhipster` will result in a Docker image named `myorg/jhipster:0.0.1-SNAPSHOT`.

1. Build the Docker image:
    ```
    ./mvnw -Pprod clean package jib:dockerBuild
    ```



The output image name can also be set by customizing the `./mvnw` command using the `-Djib.to.image` parameter. With the organization name `myneworg`, name `myapp` and version `latest`, use:
```
 ./mvnw -Pprod clean package jib:dockerBuild -Djib.to.image=myneworg/myapp:latest
```

**Note**
The output image name can be changed in the `pom.xml` file by configuring the `plugins.plugin.jib-maven-plugin.configuration.to.image` tag as follows:
```
 <plugin>
   <groupId>com.google.cloud.tools</groupId>
   <artifactId>jib-maven-plugin</artifactId>
   <configuration>
     <!-- ... -->
     <to>
       <image><!-- use a custom value here --></image>
     </to>
     <!-- ... -->
   </configuration>
 </plugin>
```



::: tip Warning
If you change the target image of the Docker build, remember to update
the plugin metadata in the bundle accordingly. Once you deploy the plugin, you will also have to change the plugin Custom Resource in the `bundle/plugins` folder to point to the correct image.
:::

## Publish the Docker image 

Publish the Docker image for the microservice to make it
available for the bundle installation in the cluster. Docker Hub or an equivalent registry will do.

    docker push <name-of-the-image:tag>

## Deploy the plugin 

 You can now deploy the plugin Custom Resource generated by the Entando Blueprint in the `bundle/plugins` folder.

From the JHipster project directory, deploy the plugin:

``` bash
cd bundle/plugins

kubectl create -f <plugin-file.yaml> -n entando
```

## Link the plugin to the App

Once the plugin server deployment is up and running, create an [EntandoAppPluginLink Custom Resource](../../../docs/consume/custom-resources.md)
to make the plugin API available from the EntandoApp domain.

Here is an example of a EntandoAppPluginLink Custom Resource. Some defaults are:
- The EntandoPlugin generated with the Blueprint is `my-demo-plugin`
- The EntandoApp exposing `my-demo-plugin` API is `quickstart`. This is the app name in the environment built with the Getting Started instructions.
- Both are deployed on the `entando` namespace
- The link is named `quickstart-to-my-demo-plugin-link`
- The name of the link yaml is `my-link.yaml`

::: tip 
Change the defaults as needed if you used your own custom names for any of these fields.
:::

```
apiVersion: entando.org/v1
kind: EntandoAppPluginLink
metadata:
  name: quickstart-to-my-demo-plugin-link
  namespace: entando
spec:
  entandoAppName: quickstart
  entandoAppNamespace: entando
  entandoPluginName: my-demo-plugin
  entandoPluginNamespace: entando
```

1. Add this link to your environment
```
kubectl create -f my-link.yaml -n entando
```

A new link deployer will start and work behind the scenes to add your plugin `ingressPath` (part of the plugin `spec`) to the EntandoApp ingress.

## Upload the Static Resources 

Now that the plugin and app are linked, generate the Micro Frontend from the App Builder
and upload the static resources like `js` and `css` files.

1. From the App Builder, go to `Configuration -> File Browser` 
2. Navigate to the `public` folder. Create a new folder using the name of the bundle (the value is in the `code` field available in the `/bundle/descriptor.yaml` file of the blueprint project) or use a custom name such as `demo-widget`.

3. Upload all the resources in the `/bundle/resources` folder of the project into the new folder

::: tip Warning
If you do not duplicate the folder name and structure of `/bundle/resources`, you will need to update the references to them in the customUI/configUI of the widget.
:::

4. In the App Builder, go to `Components → Micro frontends & Widgets`  

5. Select `Add` to create the widget

6. Enter the following with your choices for `anyname`:
- `Title: anyname1` → enter for both English and Italian languages
- `Code: anyname2` → dashes are not allowed
- `Group: Free Access`
- `Icon`:  → upload an icon of your choice

7. Under customUI, copy one of the widgets you generated with the Blueprint.
For example, the customUI for the `detailWidget` of the Conference entity is available in
`/bundle/ui/widgets/conference/detailsWidget/conference-details-widget.ftl`

8. If your path differs from the default, update the service URL to match the location where the ingress for your microservice was deployed. 

For example, update the service-URL value with the relative path of your service if you're deploying a bundle `<car-table service-url="/newBp/api"  />`.
	
Or use the full path if you're deploying the BE and FE individually
`<car-table service-url="http://newbp-plugin-entando.192.168.64.7.nip.io/newBp/api"/>`.

9. If you're creating a new page from scratch or your page is missing the Keycloak fragment, you can add it with this freemarker snippet:

```
<@wp.fragment code="keycloak_auth" escapeXml=false />
```
::: tip Note
Your Entando application includes a `keycloak_auth` fragment that will inject the token
and connection to Keycloak that your Micro Frontends need to invoke the protected APIs. To view the token, go to `Components → UX Fragments` in the App Builder and search for `keycloak_auth`.
:::

## Use the Micro Frontend and Microservice

Now the Micro Frontends and microservice is available for use in your Entando App Builder.
