---
redirectFrom: /next/tutorials/ecr/tutorials/ecr-deploy-use-plugin-and-mfe-without-bundle.html
---
# Apply Entando Blueprint Without a Bundle

## Overview

In this tutorial you will learn to apply an Entando Blueprint to a plugin and Micro Frontend generated with the Entando Component Generator in a running cluster, without the need for a bundle.

## Prerequisites

-   An Entando Plugin built with the Entando Component Generator and populated with Micro 
Frontends. [Generate a plugin and Micro Frontend here](../backend-developers/generate-microservices-and-micro-frontends.md). 

-   Node and NPM installed on your machine (use LTS version)

-   Docker installed on your machine and able to upload images to Docker Hub or an image repository of your choice

-   An instance of the Entando platform running Kubernetes. See [Getting Started](../../docs/getting-started/README.md)

::: tip Note
[Here is a definition of an Entando plugin,](../../docs/ecr/ecr-bundle-details.html#plugin) including information on the runtime contract required for using non-Java based plugins.
:::


## Generate a Docker image 

JHipster uses the JIB Maven plugin to generate a docker image for your
microservice.

The name of the output image generated with JIB during the setup wizard is defined with:
- The organization name you chose, default is set to `entando`
- The name of the application
- Version `0.0.1-SNAPSHOT`

For example, a custom organization name of `myorg` and the application name of `jhipster` will result in a docker image named `myorg/jhipster:0.0.1-SNAPSHOT`.

1. Build the docker image:
    ```
    ./mvnw -Pprod clean package jib:dockerBuild
    ```



The output image name can also be set by customizing the `./mvnw` command using the `-Djib.to.image` parameter. With the organization name `myneworg`, name `myapp` and version `latest` use:
```
 ./mvnw -Pprod clean package jib:dockerBuild -Djib.to.image=myneworg/myapp:latest
```

**Note**
The output image name can be changed in the `pom.xml` file by configuring the `plugins.plugin.jib-maven-plugin.configuration.to.image` tag as follows:
```
 <plugin>
   <groupId>com.google.cloud.tools</groupId>
   <artifactId>jib-maven-plugin</artifactId>
   <configuration>
     <!-- ... -->
     <to>
       <image><!-- use a custom value here --></image>
     </to>
     <!-- ... -->
   </configuration>
 </plugin>
```



::: tip Warning
If you change the target image of the docker build, remember to update
the plugin metadata in the bundle accordingly. You will also have to change the plugin custom resource when you deploy the plugin below in the `bundle/plugins` folder to point to the correct image.
:::

## Publish the Docker image 

Publish the docker image for the microservice to make it
available for the bundle installation in the cluster. Docker Hub or an equivalent registry will do.

    docker push <name-of-the-image:tag>

## Deploy the plugin 

 You can now deploy the plugin custom resource generated by the Entando Blueprint in the `bundle/plugins` folder.

From the JHipster project directory, deploy the plugin:

```$bash
cd bundle/plugins

kubectl create -f <plugin-file.yaml> -n entando
```

## Link the plugin to the App

Once the plugin server deployment is up and running, create an [EntandoAppPluginLink custom resource](../../docs/concepts/custom-resources.md)
to make the plugin API available from the EntandoApp domain.

Here is an example of a EntandoAppPluginLink custom resource. Some defaults of this custom resource are:
- The EntandoPlugin generated with the blueprint is `my-demo-plugin`
- The EntandoApp exposing `my-demo-plugin` API is `quickstart`. This is the app name in an environment built in the Getting Started instructions.
- Both are deployed on the `entando` namespace
- The link is named `quickstart-to-my-demo-plugin-link`
- The name of the link yaml is `my-link.yaml`

::: tip Warning
Remember to change the fields to match your setup.
:::

```
apiVersion: entando.org/v1
kind: EntandoAppPluginLink
metadata:
  name: quickstart-to-my-demo-plugin-link
  namespace: entando
spec:
  entandoAppName: quickstart
  entandoAppNamespace: entando
  entandoPluginName: my-demo-plugin
  entandoPluginNamespace: entando
```

1. Add this link to your environment
```
kubectl create -f my-link.yaml -n entando
```

A new link deployer will start and work behind the scenes to add your plugin `ingressPath` (part of the plugin `spec`) to the EntandoApp ingress.

## Upload the Static Resources 

Now that the plugin and app are linked, generate the Micro Frontend from the App Builder
and upload the static resources like `js` and `css` files.

1. From the AppBuilder go to `Configuration -> File Browser` 
2. Migrate to the `public` folder and create a new folder with the same name as the bundle (the value is in the `code` field available in the `/bundle/descriptor.yaml` file of the blueprint project) or use a custom name such as `demo-widget`.

3. Upload all the resources in the `/bundle/resources` folder of the project into the new folder

::: tip Warning
You can duplicate the folder name and structure of `/bundle/resources`, but if you do not, you need to update the references to them in the customUI/configUI of the widget later.
:::

4. In the App Builder go to `Components → Micro frontends & Widgets`  

5. Select `Add` to create the widget

6. Enter the following with your choices for `anyname`:
- `Title: anyname1` → enter both English and Italian languages
- `Code: anyname2` → dashes are not allowed
- `Group: Free Access`
- `Icon`:  → upload an icon of your choice

7. Under customUI, copy from one of the widgets you generated with the Blueprint.
For example, the customUI for the `detailWidget` of the Conference entity is available in
`/bundle/ui/widgets/conference/detailsWidget/conference-details-widget.ftl`

8. Update the service url to match the location where you deployed the ingress for your Microservice if you used a path different than the default. 

For example, update the service-url value with the relative path of your service if you're deploying a bundle `<car-table service-url="/newBp/api"  />`.
	
Or use the full path if you're deploying the BE and FE individually
`<car-table service-url="http://newbp-plugin-entando.192.168.64.7.nip.io/newBp/api"/>`.

9. If you're creating a new page from scratch or your page is missing the Keycloak fragment, you can add it with this freemarker snippet:

```
<@wp.fragment code="keycloak_auth" escapeXml=false />
```
::: tip Note
Your Entando application includes a keycloak_auth fragment that will inject the token
and connection to Keycloak that your microfrontends need to invoke the protected APIs. You can see this token at `Components → UX Fragments` in the App Builder and search for keycloak_auth.
:::

## Use the Micro Frontend and Microservice

Now the Micro Frontends and Microservice is available for use in your Entando App.
