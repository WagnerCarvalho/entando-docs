---
sidebarDepth: 2
redirectFrom: /next/tutorials/ecr/tutorials/create-ecr-bundle-from-git.html
---
# Build and Publish a Simple Bundle

## Overview
This tutorial shows how to create a simple Entando bundle and deploy it into the Entando Component Repository. This consists of manually defining a bundle with a single widget, checking the bundle artifacts into Git, applying the Entando bundle custom resource to Kubernetes, and finally installing the bundle into an application.

## Prerequisites
* Use the [Entando CLI](../../docs/reference/entando-cli.md#check-environment) to verify dependencies for this tutorial are installed (e.g. Java, npm, Git)
``` sh
ent check-env develop
```
* Git credentials, an empty Git repository and an Entando instance

The `ent prj` command and its publication system (pbs) convenience methods consolidate multiple commands into single entries. Both the simplified and uncondensed sets of commands are provided.

## Create the project structure
First create a parent project directory (e.g. `example-bundle` along with a child bundle directory. In a project generated by the Entando Component Generator the microservice and micro frontend source files live under the parent directory.

``` sh
mkdir -p example-bundle/bundle; cd example-bundle/bundle
```
## Add a simple widget

Create a widget directory:
``` sh
mkdir widgets
```

Create a widget descriptor file within that directory:
``` sh
touch widgets/example-widget.yaml
```

Populate the widget descriptor file `example-widget.yaml` with a simple definition. Make sure to retain the correct YAML indentation of 2 or 4 spaces.
``` yaml
code: example-widget
titles:
   en: Example Widget
   it: Widget d'esempio
group: free
customUi: <h2>Hi from Example Widget</h2>
```

## Create the bundle descriptor

The bundle descriptor file `descriptor.yaml` is the main file processed by the Entando Component Repository and describes all of the components within the bundle. The name of the bundle descriptor must be `descriptor.yaml` and it must be stored in the child bundle directory (e.g. `example-bundle/bundle`).
```sh
touch descriptor.yaml
```

Populate the bundle descriptor file with the following YAML definition:
``` yaml
code: example-bundle
description: This is an example of an Entando bundle
components:
  widgets:
    - widgets/example-widget.yaml
```
Component descriptor file names and locations (e.g. `widgets/example-widget.yaml`) are arbitrary since the bundle descriptor explicitly points to those files. Convention is to group components by type (e.g. all widgets in one directory, all page templates in another, etc.).

## Publish the bundle

The bundle can be published using the `ent prj` command or the equivalent steps can be performed manually.

### CLI steps with `ent prj`
1. Change to the project directory, if needed
```sh
cd example-bundle
```

2. Initialize the Entando project and accept the defaults
``` sh
ent prj init
```

3. Initialize the publication system. This step requires the empty Git repository URL (ending in .git) and your credentials.
``` sh
ent prj pbs-init
```

4. Publish the bundle to Git. By convention the first version will be `v0.0.1` but this tag can be modified.
``` sh
ent prj pbs-publish
```
Upon subsequent iterations just this command can be run again to quickly push a new version of the bundle to Git.

5. The bundle can now be deployed into the Entando Component Repository in one step
``` sh
ent prj deploy
```
 The `prj deploy` command uses the Git repository URL and project name (e.g. `example-bundle`) from earlier steps to create the custom resource.

6. Jump to [Install the bundle into an application](#install-the-bundle-into-an-application) to finish installing your bundle.

### Unsimplified CLI steps 
1. Change to the bundle directory if needed
``` sh
cd example-bundle/bundle
```

2. Run the following commands to initialize Git and commit the files
``` sh
git init
git add .
git commit -m "Init Git repository"
```

3. Add your remote repository as origin and push the bundle
``` sh
git remote add origin https://your/remote/repository.git
git push -u origin master
```
Note: To update the URL of the remote repository with the name “origin” to the URL of the remote repository you want to add use the following command:
``` sh
git remote set-url origin https://your/remote/repository.git
```

4. Publish a Git tag with the following commands
``` sh
git tag -a "v0.0.1" -m "My first tag"
git push --tags
```

5. Now that you've published your bundle to Git you can create the Kubernetes custom resource for it.

Install the bundler if you haven't previously done so
``` sh
npm install -g  @entando/entando-bundler@6.3.2
```

Next generate the custom resource for your bundle. Run the `entando-bundler from-git` command and provide your remote git repository URL via the `--repository` option and the correct namespace via `--namespace`. You can also provide a thumbnail for your bundle with `--thumbnail-file` or `--thumbnail-url`.

``` sh
entando-bundler from-git --name=example-bundle --namespace=entando --repository=https://your/remote/repository.git --dry-run > example-bundle.yaml
```

Now you can apply this definition to Kubernetes. You may need to first transfer the file to your VM (e.g by mounting the project directory).

```
kubectl -n entando apply -f example-bundle.yaml
```

If you encounter the error
```
Unable to read /etc/rancher/k3s/k3s.yaml, please start server with — write-kubeconfig-mode to modify kube config permissions

error: Error loading config file “/etc/rancher/k3s/k3s.yaml”: open /etc/rancher/k3s/k3s.yaml: permission denied
```
send the following command
```
sudo chmod -R 777 /etc/rancher/k3s/k3s.yaml
```

You can confirm the presence of your custom resource via `kubectl get EntandoDeBundle -n entando`.

## Install the bundle into an application
Now you can go to the `App Builder` → `Component Repository` and install your bundle. You should see your bundle listed; clicking `Install` you should be able to select your preferred version if the bundle contains more than one.

The Entando platform will download and install the components contained in the bundle. Once complete you should see the `Install` button change to give you the option to `Uninstall` that specific version. If you navigate to `Components` → `Micro Frontends & Widgets` should should find your custom widget under the `User` section.
